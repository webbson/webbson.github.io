{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/get-a-list-of-sitecore-users/","result":{"data":{"site":{"siteMetadata":{"title":"Tom's tech blog"}},"markdownRemark":{"id":"78e614a2-c539-5810-be2a-a62e4462b56f","excerpt":"Recently I got tasked with exporting a list of all users in a clients Sitecore installation. My immidiate though was to use Sitecore Powershell as I could write…","html":"<p>Recently I got tasked with exporting a list of all users in a clients Sitecore installation. My immidiate though was to use <a href=\"https://doc.sitecorepowershell.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Sitecore Powershell</a> as I could write the code quick and easy without having to deploy code to their production environment.</p>\n<p>For my first attempt I used the function <a href=\"https://doc.sitecorepowershell.com/appendix/security/get-user\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Get-User -Filter *</code></a> which gives a list of users in Sitecore. The properties of these users are quite limited however and I didn’t find an easy way to get properties like email and comments from them.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Name            : sitecore\\adminUser\nDomain          : sitecore\nIsAdministrator : True\nIsAuthenticated : False\nIsEnabled       : True</code></pre></div>\n<p>After quite a lot of Googling I found the command <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.security.membership.getallusers?view=netframework-4.8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">[System.Web.Security.Membership]::GetAllUsers()</code></a> which get another list of users. This list contains almost all the properties I could wish for. It was however missing properties for knowing if the user was administrator or which groups it has.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Comment                 : Is Admin\nCreationDate            : 5/23/2018 2:02:45 PM\nEmail                   : adminUser@client.com\nInnerUser               : sitecore\\adminUser\nIsApproved              : True\nIsLockedOut             : False\nLastActivityDate        : 2/9/2021 9:28:32 AM\nLastLockoutDate         : 1/1/1754 12:00:00 AM\nLastLoginDate           : 2/9/2021 9:27:55 AM\nLastPasswordChangedDate : 5/23/2018 2:02:45 PM\nPasswordQuestion        :\nProviderName            : sitecore\nProviderUserKey         : 11111111-1111-1111-1111-111111111111\nUserName                : sitecore\\adminUser\nIsOnline                : False</code></pre></div>\n<p>The solution was then to combine the two. I choose the way of fetching the users with the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.security.membership.getallusers?view=netframework-4.8\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">[System.Web.Security.Membership]::GetAllUsers()</code></a> command, and then iterating over them and then getting the user from the <a href=\"https://doc.sitecorepowershell.com/appendix/security/get-user\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><code class=\"language-text\">Get-User -Id $user.UserName</code></a> command and expanding the user object with the properties I needed from that.</p>\n<p>The final script looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token variable\">$userList</span> = <span class=\"token namespace\">[System.Web.Security.Membership]</span>::GetAllUsers<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">foreach</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$user</span> in <span class=\"token variable\">$userList</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$euser</span> = <span class=\"token function\">Get-User</span> <span class=\"token operator\">-</span>Id <span class=\"token variable\">$user</span><span class=\"token punctuation\">.</span>UserName\n    <span class=\"token function\">Add-Member</span> <span class=\"token operator\">-</span>InputObject <span class=\"token variable\">$user</span> <span class=\"token operator\">-</span>MemberType NoteProperty <span class=\"token operator\">-</span>Name <span class=\"token string\">\"IsAdministrator\"</span> <span class=\"token operator\">-</span>Value <span class=\"token variable\">$euser</span><span class=\"token punctuation\">.</span>IsAdministrator\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$users</span> = <span class=\"token variable\">$userList</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Select-Object</span> <span class=\"token operator\">-</span>Property @<span class=\"token punctuation\">{</span>Label=<span class=\"token string\">\"Email\"</span><span class=\"token punctuation\">;</span> Expression=<span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Email<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    @<span class=\"token punctuation\">{</span>Label=<span class=\"token string\">\"Is admin\"</span><span class=\"token punctuation\">;</span> Expression=<span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>IsAdministrator<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    @<span class=\"token punctuation\">{</span>Label=<span class=\"token string\">\"Username\"</span><span class=\"token punctuation\">;</span> Expression=<span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>UserName<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    @<span class=\"token punctuation\">{</span>Label=<span class=\"token string\">\"Comment\"</span><span class=\"token punctuation\">;</span> Expression=<span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>Comment<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    @<span class=\"token punctuation\">{</span>Label=<span class=\"token string\">\"Last logged in\"</span><span class=\"token punctuation\">;</span> Expression=<span class=\"token punctuation\">{</span><span class=\"token variable\">$_</span><span class=\"token punctuation\">.</span>LastLoginDate<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token variable\">$props</span> = @<span class=\"token punctuation\">{</span>\n    Title = <span class=\"token string\">\"Export user data\"</span>\n    InfoTitle = <span class=\"token string\">\"<span class=\"token function\">$<span class=\"token punctuation\">(</span><span class=\"token variable\">$users</span><span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">)</span></span> users\"</span>\n    InfoDescription = <span class=\"token string\">\"Export user data\"</span>\n    PageSize = 200\n<span class=\"token punctuation\">}</span>\n<span class=\"token variable\">$users</span> <span class=\"token punctuation\">|</span> <span class=\"token function\">Show-ListView</span> @props</code></pre></div>\n<p>It renders as <a href=\"https://doc.sitecorepowershell.com/appendix/common/show-listview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">listview</a> in Sitecore Powershell, in this the records can be sorted by the different columns and then exported to a variety of formats.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1229px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e5adc4e75c1536ae897547387b456d77/1dae5/userlist.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAACA//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAX9NoCS4/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECEwMQM//aAAgBAQABBQJY4tUopRDnr//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAICAwEAAAAAAAAAAAAAAAADMpIQERKB/9oACAEBAAY/At8rqRXUiup7n//EABYQAQEBAAAAAAAAAAAAAAAAABBx8P/aAAgBAQABPyFinGaV/9oADAMBAAIAAwAAABCzD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB8QAAIBAwUBAAAAAAAAAAAAAAABcSExsRFBYcHR8P/aAAgBAQABPxBrVyT0rzkVbL9F9TsuywFdyLeT/9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"List of users\"\n        title=\"List of users\"\n        src=\"/static/e5adc4e75c1536ae897547387b456d77/1dae5/userlist.jpg\"\n        srcset=\"/static/e5adc4e75c1536ae897547387b456d77/7cc5e/userlist.jpg 480w,\n/static/e5adc4e75c1536ae897547387b456d77/6a068/userlist.jpg 960w,\n/static/e5adc4e75c1536ae897547387b456d77/1dae5/userlist.jpg 1229w\"\n        sizes=\"(max-width: 1229px) 100vw, 1229px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Get an exportable list of users in Sitecore using Sitecore Powershell","date":"February 09, 2021","description":"Here I will show how to get a list of users in Sitecore which can be exported to an Excel or CSV file.","tags":["sitecore","powershell"]}},"previous":{"fields":{"slug":"/sitecore-database-maintenance/"},"frontmatter":{"title":"Sitecore database maintenance"}},"next":{"fields":{"slug":"/gosund-sp111-esphome/"},"frontmatter":{"title":"Gosund SP111 outlet flashed to ESPHome"}}},"pageContext":{"id":"78e614a2-c539-5810-be2a-a62e4462b56f","previousPostId":"39a2924a-4c28-5494-9917-8693a92efdc5","nextPostId":"4c7462e6-ace1-52fe-8b92-e43d6266b87b"}},"staticQueryHashes":["2841359383","3700319767"]}