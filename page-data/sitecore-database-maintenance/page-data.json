{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/sitecore-database-maintenance/","result":{"data":{"site":{"siteMetadata":{"title":"Tom's tech blog"}},"markdownRemark":{"id":"39a2924a-4c28-5494-9917-8693a92efdc5","html":"<p>One of my clients Sitecore installation started to get more and more bogged down and irresponsive. These are some basic steps I took to make sure that the databases of the solution is running as smooth as possible.</p>\n<p>The steps I took was:</p>\n<ul>\n<li><a href=\"#empty\">Emtpty recycle bin of old items</a></li>\n<li><a href=\"#cleanup\">Clean up databases</a></li>\n<li><a href=\"#fragmentation\">SQL Fragmentation</a></li>\n<li><a href=\"#remove\">Remove old item versions</a></li>\n</ul>\n<h1>Emtpty recycle bin of old items <a id=\"empty\"></a></h1>\n<p>The recycle bin had over 10 000 items dating back more than 3 years. Cleaning out everything older than a month will make it a bit lighter. This is easy to do by going into the dashboard and running the <code>Clean up deleted items</code> task under DATABASE.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 871px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f32b35cf3fb73b5d7f8192c550cd6d31/9d5da/deleted-items.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABsElEQVQoz4WSS0sCYRSG/RsudetP0P6K10W5dSW6SokI7CYmOhed8VaNwuyiTVQapF1o36pFi5iyKNPGyt7O+aQoCBp4+c4Z+J7znpfPUSqV8J/K5TJqtdov1et1NBoNIa5Zuq7DUSxsILuWwfLyCvL5PCRJQrFY/Bb3uVwOc7OzCAWDCIVCCIfDCFIdCATg9/sRiUSEUqkUHIqi0CW6XJgC2I2maahUKmIiT85ms/DNzMDn88Hr9Qp5PB643W4hl8sFp9OJaDTKQBUMVWQZMonPkqqiWq0KKK+nUp+anxcOvs50Oo1kMolEIoF4PI5YLIZMJjN1yBckWYJKtb65CZ1yYRhD2W2z2cRd/x6D5yEenwYYj1/x19ftdqdARaa1OTMCtxYX0VpdhU7OqgTVNB2GsY0b6xZPwxFG9hjPwyHe7BEhPkgTvE8mAtjpdOBgd5wbr6lSZubSElrr66hQdjVyyDkahgHLsmDbNl5IeH/D+XUfC+1LdK8sDB7uxX8B5Nx+PhGZXCm0Jg9SqecNGNput9Hr9XBycoqL8zNs7e4jppqo7+zh6PAAx7SuaZr4BKVa0PIfbXfPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f32b35cf3fb73b5d7f8192c550cd6d31/d3be9/deleted-items.webp 480w,\n/static/f32b35cf3fb73b5d7f8192c550cd6d31/81b74/deleted-items.webp 871w\"\n              sizes=\"(max-width: 871px) 100vw, 871px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f32b35cf3fb73b5d7f8192c550cd6d31/e85cb/deleted-items.png 480w,\n/static/f32b35cf3fb73b5d7f8192c550cd6d31/9d5da/deleted-items.png 871w\"\n            sizes=\"(max-width: 871px) 100vw, 871px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f32b35cf3fb73b5d7f8192c550cd6d31/9d5da/deleted-items.png\"\n            alt=\"Clean up deleted items\"\n            title=\"Clean up deleted items\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h1>Clean up databases <a id=\"cleanup\"></a></h1>\n<p>In the same menu there is an alternative called <code>Clean up databases</code>, this gives you an alternative to select which databases to clean up. I selected all of them since they all probably need it. This can take a long time to run, for this site it took 40 minutes to run all three databases with master and web being 20 GB of size.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 850px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/78c2168e8c5355183edcf3b8ad700d01/ae694/clean-up-databases.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABVElEQVQoz42Sy2rCQBSG8yruxJW6rgsRH0IXBsHn8BUEqWt9hVJbEJLm4sRJorE2KRqSjSi4F+zCW/7OjFQqWOjAxzlzhvn4B0bSlVf0n5/Q779A0zS8qSosy0K320VNrqFer6PRaIhaqVRuqFarkGVZ1Ha7jdFoBMk0LhJVUWASAuq68H0fnccOCg8FlEollMtlFItF5PN5ZLNZ5HI50afTaWQyGaRSKTSbTUynU0iEWCBMNGQQnm4wgG077NADHVMEQYAoihCGIeI4voHP5vO5YDabiZdJZDiEoelQ2cbt9eC3WrDHHj6jAN4XxfF4xH/WZrOBYRg8IRGNpuswWZ04DsbuBB+Ld9Ctgd1uh8PhgPP5fJfT6SSEq9UKpmlC4jEppSAWEXXieXCYNIoj7JM9kiS5cm/9zNfr9UXIE9q2fYEJOXwWLsLrhb9kv4XL5VL8km+/NsvoPd3hoAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/78c2168e8c5355183edcf3b8ad700d01/d3be9/clean-up-databases.webp 480w,\n/static/78c2168e8c5355183edcf3b8ad700d01/10237/clean-up-databases.webp 850w\"\n              sizes=\"(max-width: 850px) 100vw, 850px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/78c2168e8c5355183edcf3b8ad700d01/e85cb/clean-up-databases.png 480w,\n/static/78c2168e8c5355183edcf3b8ad700d01/ae694/clean-up-databases.png 850w\"\n            sizes=\"(max-width: 850px) 100vw, 850px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/78c2168e8c5355183edcf3b8ad700d01/ae694/clean-up-databases.png\"\n            alt=\"Clean up databases\"\n            title=\"Clean up databases\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>What this job does is to run the following functions:</p>\n<ul>\n<li>Cleanup CyclicDependences (items that couldn't be removed by CleanupOrphans because they have a parent but are not in the item tree)</li>\n<li>Cleanup InvalidLanguageData (remove all data from items in languages that are not defined as a valid language in the Sitecore system)</li>\n<li>Cleanup Fields (delete data from fields -SharedFields, UnversionedFields, VersionedFields- that have no related item anymore)</li>\n<li>Cleanup Orphans (delete items that have no parent anymore)</li>\n<li>Cleanup Blobs (delete blob fields that have no related field)</li>\n<li>Cleanup OrphanFields (clean the field data from the orphans removed in 4)</li>\n<li>RebuildDescendants</li>\n<li>Clear All Caches</li>\n</ul>\n<h1>SQL Fragmentation <a id=\"fragmentation\"></a></h1>\n<p>Fragmentation in the SQL database can cause serious performance issues. Thanks to <a href=\"https://mikael.com/2019/02/defragment-the-sql-server-heap-on-sitecore-databases/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this blog post</a> I got two SQL scripts that can make me find and fix the problem somewhat, and by somewhat it is that the fragmentation is only fixed for tables with an Index.\nI ran the scripts on my core, master and web databases.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> dbschemas<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> <span class=\"token string\">'Schema'</span><span class=\"token punctuation\">,</span>\n  dbtables<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> <span class=\"token string\">'Table'</span><span class=\"token punctuation\">,</span>\n  dbindexes<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">]</span> <span class=\"token keyword\">as</span> <span class=\"token string\">'Index'</span><span class=\"token punctuation\">,</span>\n  indexstats<span class=\"token punctuation\">.</span>alloc_unit_type_desc<span class=\"token punctuation\">,</span>\n  indexstats<span class=\"token punctuation\">.</span>avg_fragmentation_in_percent<span class=\"token punctuation\">,</span>\n  indexstats<span class=\"token punctuation\">.</span>page_count\n<span class=\"token keyword\">FROM</span> sys<span class=\"token punctuation\">.</span>dm_db_index_physical_stats <span class=\"token punctuation\">(</span>DB_ID<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> indexstats\n<span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> dbtables <span class=\"token keyword\">on</span> dbtables<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>object_id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> indexstats<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>object_id<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> sys<span class=\"token punctuation\">.</span>schemas dbschemas <span class=\"token keyword\">on</span> dbtables<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>schema_id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> dbschemas<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>schema_id<span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">INNER</span> <span class=\"token keyword\">JOIN</span> sys<span class=\"token punctuation\">.</span>indexes <span class=\"token keyword\">AS</span> dbindexes <span class=\"token keyword\">ON</span> dbindexes<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>object_id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> indexstats<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>object_id<span class=\"token punctuation\">]</span>\n<span class=\"token operator\">AND</span> indexstats<span class=\"token punctuation\">.</span>index_id <span class=\"token operator\">=</span> dbindexes<span class=\"token punctuation\">.</span>index_id\n<span class=\"token keyword\">WHERE</span> indexstats<span class=\"token punctuation\">.</span>database_id <span class=\"token operator\">=</span> DB_ID<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> indexstats<span class=\"token punctuation\">.</span>avg_fragmentation_in_percent <span class=\"token keyword\">desc</span></code></pre></div>\n<p>This script shows the fragmentation of the different tables in the database. And as seen below it was quite extensive on my master db.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 681px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/70291c5a64ebe2c5efd7cfcbaeb7e44e/8ce52/fragmentation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 92.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADGklEQVQ4y11UCXLiQBDj/z9LUtnlSMAGH/jCFxgbY7C5eqUGTLJUUQUzPRqppZ6B5wfiBZHEcSLbbSlt20qaZlKWpXRdJ1VVief5slx62N9KFEZiWbZ4+J9lOdYKCcMQ9ZWcz2cZBFEk5a4W13UBGgPwCAAPoKnwc2gaMc25gpxPZ3FQN5vNxMDa9XrF2kkSkHl+BpvNRk7nkzi2LdPpTFn6vq8A6/VGSrAyjbnM5wvp2k4Bh8OhTGeGAlIFidxuN/0OKKnDLRGYhpCjkpNUtsVWCw6HRiVz74Q6HrYXtraAgFxjK3rA9XqtII7tSAKZl8tF2cbJXcZ+X4Odpfs8zN7NoMQ0Ta3lGnt+Q60C5nmuDAkyHo8lz9d6yHGXd8C6BoAhc3Oh8izLktFwJMaMgGTYSQ5z5AlIuryFTBsYcDgcZLVaCXurpvwnmXtzsHMcp2dYou89wzRLpe1adfYE2/lZup4sFs5DcoPfL8kE/JqM1XkCsF1FUbwYJugVpdiQcsTm7XYFuIG+uCipIbmA+wacNlF30ni9v73J9/f0Bbj5AVhWpcYmBfBqFSuLPAsB6KMFhRwPNWIUaKCpgPkk2yAIepe5xt93yfjTobE2TKG0ChcEPhnauLOSZl9g3UbPXD1MoNl0KgYYPwF/5ZBRoWQ2mY0neBT6MhmPpNqVYNho4NmzFsGm5L+ff3TtGewsy364jJnlDK6ilYI+C9KUcTrL8XjUEAdB2JtiW/dgX6732NyD/QDkYeZwidyxaLercGgi58sKd6aQnCJ7jjIjIB8CSnZRf73eQKDVyP12GYXWYqF9atuDhMEHDGAPl3A5hDxTJ4PsGa8/n5/y/ZBMl5PHVL2CTfewyFvr/U7W+RfawEnxEewEIEEvmXPOiPFyStZ2IR29yxlH73EzX5dTd4RrQ6y5KPAgGY+B7eplBEySGGNnKODL5USuvctgxkXTMDDLE2RvD4NMGGOh2WBcrxFiQ0FYx6ft4/1dRqPxA7BTk/rYFHhx267T4D5jE8cupHPgG4we38dQ96mEDPmgcuYplyng3HOuCfgPJ4WXvJPz4rYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/70291c5a64ebe2c5efd7cfcbaeb7e44e/d3be9/fragmentation.webp 480w,\n/static/70291c5a64ebe2c5efd7cfcbaeb7e44e/9a301/fragmentation.webp 681w\"\n              sizes=\"(max-width: 681px) 100vw, 681px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/70291c5a64ebe2c5efd7cfcbaeb7e44e/e85cb/fragmentation.png 480w,\n/static/70291c5a64ebe2c5efd7cfcbaeb7e44e/8ce52/fragmentation.png 681w\"\n            sizes=\"(max-width: 681px) 100vw, 681px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/70291c5a64ebe2c5efd7cfcbaeb7e44e/8ce52/fragmentation.png\"\n            alt=\"Fragmentation\"\n            title=\"Fragmentation\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">DECLARE</span> <span class=\"token variable\">@TableName</span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">DECLARE</span> TableCursor <span class=\"token keyword\">CURSOR</span> <span class=\"token keyword\">FOR</span>\n<span class=\"token keyword\">SELECT</span> table_name <span class=\"token keyword\">FROM</span> information_schema<span class=\"token punctuation\">.</span><span class=\"token keyword\">tables</span> <span class=\"token keyword\">WHERE</span> table_type <span class=\"token operator\">=</span> <span class=\"token string\">'base table'</span>\n<span class=\"token keyword\">OPEN</span> TableCursor\n    <span class=\"token keyword\">FETCH</span> <span class=\"token keyword\">NEXT</span> <span class=\"token keyword\">FROM</span> TableCursor <span class=\"token keyword\">INTO</span> <span class=\"token variable\">@TableName</span>\n    <span class=\"token keyword\">WHILE</span> @<span class=\"token variable\">@FETCH_STATUS</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">BEGIN</span>\n        <span class=\"token keyword\">DBCC</span> DBREINDEX<span class=\"token punctuation\">(</span><span class=\"token variable\">@TableName</span><span class=\"token punctuation\">,</span><span class=\"token string\">' '</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">FETCH</span> <span class=\"token keyword\">NEXT</span> <span class=\"token keyword\">FROM</span> TableCursor <span class=\"token keyword\">INTO</span> <span class=\"token variable\">@TableName</span>\n    <span class=\"token keyword\">END</span>\n<span class=\"token keyword\">CLOSE</span> TableCursor\n<span class=\"token keyword\">DEALLOCATE</span> TableCursor</code></pre></div>\n<p>This script reindexes the database and thus fixes some of the fragmentation. Although not percect, the scores are way better than before.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 684px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d2e000febbffc25bc4a2f22b3f740424/2c288/defragmentation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC+klEQVQ4y3VUi5KiQBDb//+23fK2fAAKiIgg8pCnDKDm0oOyd1d1U2XtwnRn0kmGj6ZpYe0cHPwAnuehUz3qKkcYGng8EjyfCaLwCMOwEAQBrtcCm80Gi8WCNSG6ruN+iDzPcb/f8VFVFTI+3G43+L4P/xigKM7Ism+CeQB8JEmIHQ/NX3Wu68I0TIJfISvLMvR9r//XgGVZolcKAcHquuWpV4IIoM+SI9I0gut4yDMCktF+v8fW2mq2snICDsPA+ic+BCzNUk3dsiyY1g5Nk+F8XsyA8Tkgoy0ulwtubQt7Z2O5XPHQRAPGcYyqrieGRVFqyi0LZZQ0zdESMIo+uX3QI0eRj9Vyw0POUKrDerXG1+cXn2MNEp5OEBwNKLoIoDDckmEcJ2yqWPSLYxxZcua7E0yTDOOLrnMdR0+TpqkGEaairQYsiVxwbEUNYzbIGocex6OL/CrPd93g2O7LFGrMWlmimfykVxzWGhZFoRnKS9u22dCRWcdIbDGO4mJNwJh7LrI00xoq1f8fUIouSaJfWqYFx9lzlJBGLFkQsi2iVgGzZ86muA5jY5qsyzRwyv6+H14aZhOgaGNsDI564uaN0TDYIBq2BIxohKHdbNtGx6emq+o1elVWGMZxApRxJdiyKS5LuOu6wcE7IoxiZrTR2m4ZpzfD0ynkrTlBMixLDHk8HtPIIrSYIgwlFqJp05SMisO/8ayht/d0o9SJTMkl0VGTdSXG+9ZMDHUOyerg86QnR255r7/pZsSSgnGJtCnSJICP52M2RVZJEm37io3oMpnSMbwrRqOgy4rgNrdF6JFsQ6xWU7A7pmCkXgImY8qSd/PIokvyApQL7/Oro5Sw3XD8gOAZNaQpa2MGfEfkzfBGdj+x4bgyinwtfI4sYit14yfJI/iOBqXUbAq26Ku6n8y9WYkMM6Bk6cpCDUiHD/wp1ZKVSzDRsNGm7F1Pm/BniKeRn9qsvxgmrxxKsG3e044sbH7/5P4Ow8i4JNz7ucv/aigTvjP5G7ynVwNY6NUSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d2e000febbffc25bc4a2f22b3f740424/d3be9/defragmentation.webp 480w,\n/static/d2e000febbffc25bc4a2f22b3f740424/e213b/defragmentation.webp 684w\"\n              sizes=\"(max-width: 684px) 100vw, 684px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d2e000febbffc25bc4a2f22b3f740424/e85cb/defragmentation.png 480w,\n/static/d2e000febbffc25bc4a2f22b3f740424/2c288/defragmentation.png 684w\"\n            sizes=\"(max-width: 684px) 100vw, 684px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d2e000febbffc25bc4a2f22b3f740424/2c288/defragmentation.png\"\n            alt=\"After defragmentation\"\n            title=\"After defragmentation\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h1>Remove old item versions <a id=\"remove\"></a></h1>\n<p>The final thing I did was to get rid of old versions of items. Being a multilanguage site with active content work and workflows some items had over 60 versions. To battle this I made a simple PowerShell script which will remove X old versions so that each item only has a select number of versions saved. This script is not a perfect solution as I need to run it manually, but I will add running it to my monthly maintenance round.</p>\n<p>There are also some limitations as it limits the versions depending on the item version number on the webdatabase. Not counting for that there might be versions removed manually before the last version in web database.</p>\n<p><div id=\"gist108867782\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-sitecore-remove-old-item-versions-ps1\" class=\"file my-2\">\n    \n  <div itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-powershell  \">\n      \n<table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\" data-paste-markdown-skip>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">&lt;#</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\">  This script will remove old versions of items in all languages so that the items only contains a selected number of versions.</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">#&gt;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">$item</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">Get-Item</span> <span class=\"pl-k\">-</span>Path <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>master:\\content<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">$dialogProps</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">@</span>{</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC7\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">Parameters</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">@</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC8\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">@</span>{ <span class=\"pl-smi\">Name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>item<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Title</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Branch to analyse<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Root</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>/sitecore/content/Home<span class=\"pl-pds\">&quot;</span></span>}<span class=\"pl-k\">,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC9\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">@</span>{ <span class=\"pl-smi\">Name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>count<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Value</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">10</span>; <span class=\"pl-smi\">Title</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Max number of versions<span class=\"pl-pds\">&quot;</span></span>;  <span class=\"pl-smi\">Editor</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>number<span class=\"pl-pds\">&quot;</span></span>}<span class=\"pl-k\">,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC10\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">@</span>{ <span class=\"pl-smi\">Name</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>remove<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Value</span><span class=\"pl-k\">=</span><span class=\"pl-c1\">$False</span>; <span class=\"pl-smi\">Title</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Do you wish to remove items?<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Editor</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>check<span class=\"pl-pds\">&quot;</span></span>}</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC11\" class=\"blob-code blob-code-inner js-file-line\">    )</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC12\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">Title</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Limit item version count<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC13\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">Description</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Sitecore recommends keeping 10 or fewer versions on any item, but policy may dictate this to be a higher number.<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC14\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">Width</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">500</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC15\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">Height</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">280</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC16\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">OkButtonName</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Proceed<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC17\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">CancelButtonName</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Abort<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC18\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC19\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">$result</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">Read-Variable</span> <span class=\"pl-smi\">@dialogProps</span> </td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC21\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC22\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">if</span>(<span class=\"pl-smi\">$result</span> <span class=\"pl-k\">-ne</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>ok<span class=\"pl-pds\">&quot;</span></span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC23\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c1\">Close-Window</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC24\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">Exit</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC25\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC26\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC27\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">$items</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">@</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC28\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c1\">Get-Item</span> <span class=\"pl-k\">-</span>Path master: <span class=\"pl-k\">-</span>ID <span class=\"pl-smi\">$item<span class=\"pl-smi\">.ID</span></span> <span class=\"pl-k\">-</span>Language <span class=\"pl-k\">*</span> <span class=\"pl-k\">|</span> <span class=\"pl-c1\">ForEach-Object</span> { <span class=\"pl-smi\">$items</span> <span class=\"pl-k\">+=</span> <span class=\"pl-k\">@</span>(<span class=\"pl-c1\">$_</span>) <span class=\"pl-k\">+</span> <span class=\"pl-k\">@</span>((<span class=\"pl-c1\">$_<span class=\"pl-smi\">.Axes.GetDescendants</span></span>())) <span class=\"pl-k\">|</span> <span class=\"pl-c1\">Where-Object</span> { <span class=\"pl-c1\">$_<span class=\"pl-smi\">.Versions.Count</span></span> <span class=\"pl-k\">-gt</span> <span class=\"pl-smi\">$count</span> } <span class=\"pl-k\">|</span> <span class=\"pl-c1\">Initialize-Item</span> }</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC29\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">$ritems</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">@</span>()</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC30\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-smi\">$items</span> <span class=\"pl-k\">|</span> <span class=\"pl-c1\">ForEach-Object</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC31\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">$webVersion</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">Get-Item</span> <span class=\"pl-k\">-</span>Path web: <span class=\"pl-k\">-</span>ID <span class=\"pl-c1\">$_<span class=\"pl-smi\">.ID</span></span> <span class=\"pl-k\">-</span>Language <span class=\"pl-c1\">$_<span class=\"pl-smi\">.Language</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC32\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">$webVersion</span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC33\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">$minVersion</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">$webVersion<span class=\"pl-smi\">.Version.Number</span></span> <span class=\"pl-k\">-</span> <span class=\"pl-smi\">$count</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC34\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">$ritems</span> <span class=\"pl-k\">+=</span> <span class=\"pl-c1\">Get-Item</span> <span class=\"pl-k\">-</span>Path master: <span class=\"pl-k\">-</span>ID <span class=\"pl-c1\">$_<span class=\"pl-smi\">.ID</span></span> <span class=\"pl-k\">-</span>Language <span class=\"pl-c1\">$_<span class=\"pl-smi\">.Language</span></span> <span class=\"pl-k\">-</span>Version <span class=\"pl-k\">*</span> <span class=\"pl-k\">|</span> <span class=\"pl-c1\">Where-Object</span> { <span class=\"pl-c1\">$_<span class=\"pl-smi\">.Version.Number</span></span> <span class=\"pl-k\">-le</span> <span class=\"pl-smi\">$minVersion</span> }</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC35\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC36\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC37\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">if</span> (<span class=\"pl-smi\">$remove</span>) {</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC38\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">$toRemove</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">$ritems<span class=\"pl-smi\">.Count</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC39\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">$ritems</span> <span class=\"pl-k\">|</span> <span class=\"pl-c1\">ForEach-Object</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC40\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-c1\">$_</span> <span class=\"pl-k\">|</span> <span class=\"pl-c1\">Remove-ItemVersion</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC41\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC42\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c1\">Show-Alert</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Removed <span class=\"pl-smi\">$toRemove</span> versions<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC43\" class=\"blob-code blob-code-inner js-file-line\">} <span class=\"pl-k\">else</span> {</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC44\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">$reportProps</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">@</span>{</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC45\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">Property</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">@</span>(</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC46\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>DisplayName<span class=\"pl-pds\">&quot;</span></span><span class=\"pl-k\">,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC47\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">@</span>{<span class=\"pl-smi\">Name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Version<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Expression</span><span class=\"pl-k\">=</span>{<span class=\"pl-c1\">$_<span class=\"pl-smi\">.Version</span></span>}}<span class=\"pl-k\">,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC48\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">@</span>{<span class=\"pl-smi\">Name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Path<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Expression</span><span class=\"pl-k\">=</span>{<span class=\"pl-c1\">$_<span class=\"pl-smi\">.ItemPath</span></span>}}<span class=\"pl-k\">,</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC49\" class=\"blob-code blob-code-inner js-file-line\">            <span class=\"pl-k\">@</span>{<span class=\"pl-smi\">Name</span><span class=\"pl-k\">=</span><span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Language<span class=\"pl-pds\">&quot;</span></span>; <span class=\"pl-smi\">Expression</span><span class=\"pl-k\">=</span>{<span class=\"pl-c1\">$_<span class=\"pl-smi\">.Language</span></span>}}</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC50\" class=\"blob-code blob-code-inner js-file-line\">        )</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC51\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">Title</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Versions proposed to remove<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC52\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">InfoTitle</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>Sitecore recommendation: Limit the number of versions of any item to the fewest possible.<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC53\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-smi\">InfoDescription</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">&quot;</span>The report shows all items that have more than &lt;b&gt;<span class=\"pl-smi\">$count</span> versions&lt;/b&gt;.<span class=\"pl-pds\">&quot;</span></span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC54\" class=\"blob-code blob-code-inner js-file-line\">    }</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC55\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-smi\">$ritems</span> <span class=\"pl-k\">|</span> <span class=\"pl-c1\">Show-ListView</span> <span class=\"pl-smi\">@reportProps</span></td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC56\" class=\"blob-code blob-code-inner js-file-line\">}</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC57\" class=\"blob-code blob-code-inner js-file-line\">\n</td>\n      </tr>\n      <tr>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"></td>\n        <td id=\"file-sitecore-remove-old-item-versions-ps1-LC58\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c1\">Close-Window</span></td>\n      </tr>\n</table>\n\n\n  </div>\n\n  </div>\n</div>\n\n      </div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/webbson/532c66d562a6905387ca3a141bdd10ad/raw/8d7f92129061f32f557241039da9699db4775d62/Sitecore%20remove%20old%20item%20versions.ps1\" style=\"float:right\">view raw</a>\n        <a href=\"https://gist.github.com/webbson/532c66d562a6905387ca3a141bdd10ad#file-sitecore-remove-old-item-versions-ps1\">Sitecore remove old item versions.ps1</a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub</a>\n      </div>\n    </div>\n</div></p>\n<hr>\n<p>With these steps done the site runs way smoother than before. There might come more posts on this matter as I'm not fully satisfied yet.</p>","frontmatter":{"title":"Sitecore database maintenance","date":"April 07, 2021","description":"Some steps to make sure that Sitecore runs as smooth as possible.","tags":["sitecore","database","performance"]}},"previous":{"fields":{"slug":"/slow-login-on-sitecore-9.0.1/"},"frontmatter":{"title":"Slow login on Sitecore 9.0.1/9.0.2"}},"next":{"fields":{"slug":"/get-a-list-of-sitecore-users/"},"frontmatter":{"title":"Get an exportable list of users in Sitecore using Sitecore Powershell"}}},"pageContext":{"id":"39a2924a-4c28-5494-9917-8693a92efdc5","previousPostId":"9c8f5756-d92f-5980-96e2-a08bafae1c01","nextPostId":"78e614a2-c539-5810-be2a-a62e4462b56f"}},"staticQueryHashes":["2841359383","3700319767"]}